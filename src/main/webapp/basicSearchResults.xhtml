<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (c) 2013 Berner Fachhochschule, Switzerland.
Bern University of Applied Sciences, Engineering and Information Technology,
Research Institute for Security in the Information Society, E-Voting Group,
Biel, Switzerland.

Project UniVote.

Distributable under GPL license.
See terms of license at gnu.org.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"  
      xmlns:f="http://java.sun.com/jsf/core"  
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">  

    <h:head>
        <link rel="stylesheet" href="resources/style.css" type="text/css"/>

        <title>UniBoard Inspector</title>
        <h:outputStylesheet name="style.css"/>
    </h:head>       
    <h:body>
        <p:layout fullPage="true">
            <p:layoutUnit style="background-color: darkgray; text-align: center" position="north" resizable="true" size="50" minSize="120" maxSize="200">
                <p:panel style="background-color: lightcyan">
                    <br /> <br />
                    <h:outputText value="UniBoard Inspector" styleClass="heading"/> 
                    <br /> <br /> <br /> 
                </p:panel>
            </p:layoutUnit>

            <p:layoutUnit id="side" position="west" resizable="true"  size="300" minSize="300" maxSize="500">
                <p:panel style="background-color: lightcyan">
                    <p:outputLabel value="Basic Search" styleClass="title" /> <br /> <br />
                    <h:form id="main">
                        <h:panelGrid columns="2">
                            <h:outputText value="Section:" styleClass="info"/>
                            <p:selectOneMenu value="#{basicSearchBean.section}">
                                <f:selectItem itemLabel="Select Section" itemValue=""/>
                                <f:selectItems value="#{populateBean.sections}" var="section"
   			              itemLabel="#{section}" itemValue="#{section}" /> 
                            </p:selectOneMenu>

                            <h:outputText value="Group:" styleClass="info"/>
                            <p:selectOneMenu value="#{basicSearchBean.group}">
                                <f:selectItem itemLabel="Select Group" itemValue=""/>
                                <f:selectItems value="#{populateBean.groups}" var="group"
   			itemLabel="#{group}" itemValue="#{group}" /> 
                            </p:selectOneMenu>

                            <h:outputText value="From Date:" styleClass="info" /> 
                            <p:calendar size="15" value="#{basicSearchBean.dateFrom}" pattern="dd/MM/yyyy HH:mm" navigator="true"/>
                            
                            <h:outputText value="To   Date:" styleClass="info"/>  
                            <p:calendar size="15" value="#{basicSearchBean.dateTo}" pattern="dd/MM/yyyy HH:mm" navigator="true"/>

                            <h:outputText value="Limit:" styleClass="info"/>
                            <p:spinner min="1" size="12" value="#{basicSearchBean.limit}"/>
                        </h:panelGrid>
                        <br/> <br /> <br />
                        <p:commandButton value="Inspect" styleClass="p_inspectButton" id="inspectButton" action="#{basicSearchBean.inspectBasicSearch()}"/>
                        <br/><br/> <br />
                        <p:commandLink value="Advanced Search" styleClass="title" onclick="PF('advancedSearch').show();"  />
                        <br/><br/> <br/>
                        <p:commandButton value="View Top 50 Most Recent Posts" style="font-weight: bold; color: red;" action="#{basicSearchBean.home()}" />
                    </h:form>
                    <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
                </p:panel>
            </p:layoutUnit>

            <p:layoutUnit position="center">
                <h:outputText value="Basic Search Results" styleClass="info"/>
                <h:form id="centerPane" >
                    <p:dataTable value="#{basicSearchBean.searchResults}"  var="postData" scrollable="true" scrollWidth="100%">
                        <p:columnGroup type="header">
                            <p:row>
                                <p:column rowspan="2" headerText="View Post"/>
                                <p:column rowspan="2" headerText="Date"/>
                                <p:column rowspan="2"  headerText="Rank"/>
                                <p:column colspan="#{basicSearchBean.messageSize}" width="" headerText="Message" />
                            </p:row>

                            <p:row>
                                <c:forEach var="i" begin="0" end="#{basicSearchBean.messageSize-1}">
                                    <p:column headerText="#{basicSearchBean.messageKeys.get(i)}" />
                                </c:forEach>
                            </p:row>
                        </p:columnGroup>

                        <p:column id="viewPost">
                            <h:commandButton value="View Post" style="font-weight: bold" action="#{viewPostBean.postDetails(postData)}" />
                        </p:column>

                        
                        <p:column id="dateHeader" sortBy="#{postData.date}">
                            <h:outputText value="#{postData.date}" />
                        </p:column>

                        <p:column id="rankHeader">
                            <h:outputText value="#{postData.rank}" />
                        </p:column>

                        <p:columns value="#{basicSearchBean.messageKeys}" var="parameter">
                            <h:outputText value="#{postData.getParameterValue(parameter)}" />
                        </p:columns>

                    </p:dataTable>
                </h:form>
            </p:layoutUnit>
            <p:layoutUnit position="south" resizable="true" size="20">
            </p:layoutUnit>
        </p:layout>

        <!--******************************************** Dialog for Advanced Search ********************************** -->
         <p:dialog header="Advanced Search" widgetVar="advancedSearch" modal="true" height="500" width="1000">
            <h:form id="advancedSearchForm2">
                <h:panelGrid columns="4">

                    <p:column>
                        <h:outputText value="Section:" styleClass="info"/>
                    </p:column>
                    <p:column>
                        <p:selectOneRadio id="b1" binding="#{sectionScope}" value="#{advancedSearchBean.sectionScope}">
                            <f:selectItem itemLabel="All" itemValue="All" />
                            <p:ajax update="sections" />
                        </p:selectOneRadio>
                    </p:column>
                    <p:column>
                        <p:selectManyCheckbox id="sections2" value="#{advancedSearchBean.sections}" layout="grid" columns="3">
                            <f:selectItems value="#{populateBean.sections}" />
                        </p:selectManyCheckbox>
                    </p:column>
                    <p:column>
                        <h:outputText id="section_error" value="Error message" />
                    </p:column>

                    <p:column>
                        <h:outputText value="Group:" styleClass="info"/>
                    </p:column>
                    <p:column>
                        <p:selectOneRadio id="b2" value="#{advancedSearchBean.groupScope}">
                            <f:selectItem itemLabel="All" itemValue="All" />
                        </p:selectOneRadio>
                    </p:column>
                    <p:column>
                        <p:selectManyCheckbox id="b3" value="#{advancedSearchBean.groups}" layout="grid" columns="3">
                            <f:selectItems value="#{populateBean.groups}" />
                        </p:selectManyCheckbox>
                    </p:column>
                    <p:column>
                        <h:outputText id="group_error" value="Error message" />
                    </p:column>

                    <p:column>
                        <h:outputText value="Date:" styleClass="info"/> 
                    </p:column>
                    <p:column>
                        <h:outputText value="From" style="text-align: center" />
                    </p:column>
                    <p:column>
                        <p:calendar size="15" value="#{advancedSearchBean.dateFrom}" pattern="dd/MM/yyyy HH:mm" navigator="true"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="date_error1" value="Error message" />
                    </p:column>

                    <p:column>
                        <h:outputText  value=" " />
                    </p:column>
                    <p:column>
                        <h:outputText value="Before"  />
                    </p:column>
                    <p:column>
                        <p:calendar size="15" value="#{advancedSearchBean.dateTo}" pattern="dd/MM/yyyy HH:mm" navigator="true"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="date_error2" value="Error message" />
                    </p:column>

                    <p:column>
                        <h:outputText value="Rank:" styleClass="info"/>  
                    </p:column>
                    <p:column>
                        <p:selectOneRadio id="b4" binding="#{rankScope}" layout="grid" columns="1" >
                            <f:selectItem itemLabel="Equal To" itemValue="Equal To" />
                            <f:selectItem itemLabel="Less Than" itemValue="Less Than" />
                            <f:selectItem itemLabel="More Than" itemValue="More Than" />
                            <f:selectItem itemLabel="Between" itemValue="Between" />
                            <p:ajax update="rank2b" />
                        </p:selectOneRadio>
                    </p:column>
                    <p:column>
                        <p:spinner min="1" size="12"/> <br /> 
                        <p:spinner id="rank2b" disabled="#{rankScope.value != 'Between'}" min="1" size="12"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="rank_error1" value="Error message" />
                    </p:column>

                    <p:column>
                        <h:outputText value="Limit:" styleClass="info"/>
                    </p:column>
                    <p:column>
                        <p:spinner min="1" size="12" value="#{advancedSearchBean.limit}"/>
                    </p:column>
                    <p:column>
                        <p:outputLabel value=" "/>
                    </p:column>
                </h:panelGrid>
                <br/> <br /> <br />
                <p:commandButton value="Inspect" styleClass="p_inspectButton" id="inspectButton2" action="#{advancedSearchBean.inspect()}"/>
            </h:form>
        </p:dialog> 
        <!-- *********************************** Dialog for Post View *********************************  -->

        <p:dialog header="Post Details" widgetVar="viewPost" height="550" width="800" >
            <h:form id="postForm">
                <p:growl id="msgs" showDetail="true" />
                <h:panelGrid columns="2" >
                    <h:outputText value="Section:" styleClass="info"/> 
                    <h:outputText value="#{viewPostBean.section}" />
                    <h:outputText value="Group:" styleClass="info"/> 
                    <h:outputText value="#{viewPostBean.group}"/>
                    <h:outputText value="Rank:" styleClass="info"/> 
                    <h:outputText value="#{viewPostBean.rank}"/>
                    <h:outputText value="Timestamp:" styleClass="info"/> 
                    <h:outputText value="#{viewPostBean.timeStamp}"/>
                    <h:outputText value="Message:" styleClass="info"/>  
                    <p:fieldset legend="" toggleable="true" toggleSpeed="500" collapsed="false">
                        <p:ajax event="toggle" listener="#{fieldsetView.handleToggle}" update="msgs" />
                        <h:panelGrid columns="1" cellpadding="5">
                            <h:outputText escape="false" value="#{viewPostBean.message}">                  
                            </h:outputText>
                        </h:panelGrid>
                    </p:fieldset>
                    <h:outputText value="Signature:" styleClass="info"/>  
                    <p:fieldset legend="" toggleable="true" toggleSpeed="500" collapsed="false">
                        <p:ajax event="toggle" listener="#{fieldsetView.handleToggle}" update="msgs" />
                        <h:panelGrid columns="1" cellpadding="5">
                            <h:outputText value="#{viewPostBean.signature}">                  
                            </h:outputText>
                        </h:panelGrid>
                    </p:fieldset>
                    <h:outputText value="Public Key:" styleClass="info"/>  
                    <p:fieldset legend="" toggleable="true" toggleSpeed="500" collapsed="false">
                        <p:ajax event="toggle" listener="#{fieldsetView.handleToggle}" update="msgs" />
                        <h:panelGrid columns="1" cellpadding="5">
                            <h:outputText value="#{viewPostBean.publicKey}">                  
                            </h:outputText>
                        </h:panelGrid>
                    </p:fieldset>
                    <h:outputText value="Board Signature:" styleClass="info"/>  
                    <p:fieldset legend="" toggleable="true" toggleSpeed="500" collapsed="false">
                        <p:ajax event="toggle" listener="#{fieldsetView.handleToggle}" update="msgs" />
                        <h:panelGrid columns="1"  cellpadding="5">
                            <h:outputText value="#{viewPostBean.boardSignature}">                  
                            </h:outputText>
                        </h:panelGrid>
                    </p:fieldset>
                    <h:outputText value="Hash:" styleClass="info"/>  
                    <p:fieldset legend="" toggleable="true" toggleSpeed="500" collapsed="false">
                        <p:ajax event="toggle" listener="#{fieldsetView.handleToggle}" update="msgs" />
                        <h:panelGrid columns="1" cellpadding="5">
                            <h:outputText value="d41d8cd98f00b204e9800998ecf8427 
                                          75cdbfeb70a06d42210938da88c42991
                                          6e0b7a1676ec0279139b3f39bd65e41a  
                                          c74c812e4d2839fa9acf0aa0c915e022">                  
                            </h:outputText>
                        </h:panelGrid>
                    </p:fieldset>
                    <h:outputText value="Confirmation:" styleClass="info"/>  
                    <p:fieldset legend="" toggleable="true" toggleSpeed="500" collapsed="false">
                        <p:ajax event="toggle" listener="#{fieldsetView.handleToggle}" update="msgs" />
                        <h:panelGrid columns="1" cellpadding="5">
                            <h:outputText value="-------BEGIN SIGNATURE------ 
                                          IQB1AwUBMVSiA5QYCuMfgNYjAQFAKgL/ZkBfbeNEsbthba4BlrcnjaqbcKgNv+ 
                                          a5kr4537y8RCd+RHm75yYh5xxA1ojELwNhhb7cltrp2V7LlOnAelws4S87UX80c 
                                          LBtBcN6AACf11qymC2h+Rb2j5SU+rmXWru+=QFMx 
                                          ------END SIGNATURE------">                  
                            </h:outputText>
                        </h:panelGrid>
                    </p:fieldset>
                </h:panelGrid>  
            </h:form>
        </p:dialog>
    </h:body>
</html>
